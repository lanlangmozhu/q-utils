<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Array 工具函数示例 - Q-Utils</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
      padding: 20px;
      max-width: 1200px;
      margin: 0 auto;
      background: #f5f5f5;
    }
    h1 {
      color: #333;
      margin-bottom: 10px;
    }
    .subtitle {
      color: #666;
      margin-bottom: 30px;
    }
    .function-group {
      margin-bottom: 30px;
      background: white;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .function-group h2 {
      color: #4a90e2;
      margin-bottom: 15px;
      padding-bottom: 10px;
      border-bottom: 2px solid #4a90e2;
    }
    .function-item {
      margin-bottom: 20px;
      padding: 15px;
      background: #f9f9f9;
      border-radius: 4px;
      border-left: 3px solid #4a90e2;
    }
    .function-name {
      font-weight: bold;
      color: #333;
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
    }
    .function-controls {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 10px;
    }
    input, textarea {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-size: 14px;
    }
    input[type="text"], input[type="number"] {
      width: 200px;
    }
    textarea {
      width: 100%;
      min-height: 60px;
      font-family: 'Courier New', monospace;
    }
    button {
      padding: 8px 16px;
      background: #4a90e2;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      transition: background 0.3s;
    }
    button:hover {
      background: #357abd;
    }
    .result {
      margin-top: 10px;
      padding: 10px;
      background: #fff;
      border: 1px solid #ddd;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      white-space: pre-wrap;
      word-break: break-all;
      max-height: 200px;
      overflow-y: auto;
    }
    .result.success {
      border-color: #4caf50;
      background: #f1f8f4;
    }
    .result.error {
      border-color: #f44336;
      background: #ffebee;
    }
    .back-link {
      display: inline-block;
      margin-bottom: 20px;
      color: #4a90e2;
      text-decoration: none;
    }
    .back-link:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <a href="index.html" class="back-link">← 返回示例首页</a>
  <h1>Array 工具函数示例</h1>
  <p class="subtitle">展示数组操作相关的所有工具函数</p>

  <!-- 基础操作 -->
  <div class="function-group">
    <h2>基础操作</h2>
    
    <div class="function-item">
      <div class="function-name">isEmpty(arr)</div>
      <div class="function-controls">
        <input type="text" id="isEmpty-input" placeholder="输入数组，如: [1,2,3]" value="[1,2,3]">
        <button onclick="testIsEmpty()">测试</button>
      </div>
      <div id="isEmpty-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">first(arr)</div>
      <div class="function-controls">
        <input type="text" id="first-input" placeholder="输入数组" value="[1,2,3,4,5]">
        <button onclick="testFirst()">测试</button>
      </div>
      <div id="first-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">last(arr)</div>
      <div class="function-controls">
        <input type="text" id="last-input" placeholder="输入数组" value="[1,2,3,4,5]">
        <button onclick="testLast()">测试</button>
      </div>
      <div id="last-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">chunk(arr, size)</div>
      <div class="function-controls">
        <input type="text" id="chunk-arr" placeholder="数组" value="[1,2,3,4,5,6,7,8]">
        <input type="number" id="chunk-size" placeholder="块大小" value="3">
        <button onclick="testChunk()">测试</button>
      </div>
      <div id="chunk-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">flatten(arr, depth?)</div>
      <div class="function-controls">
        <input type="text" id="flatten-input" placeholder="嵌套数组" value="[1,[2,[3,4]],5]">
        <button onclick="testFlatten()">测试</button>
      </div>
      <div id="flatten-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">unique(arr)</div>
      <div class="function-controls">
        <input type="text" id="unique-input" placeholder="数组" value="[1,2,2,3,3,4]">
        <button onclick="testUnique()">测试</button>
      </div>
      <div id="unique-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">uniqueBy(arr, key)</div>
      <div class="function-controls">
        <textarea id="uniqueBy-input" placeholder='对象数组，如: [{"id":1},{"id":1},{"id":2}]'>[{"id":1,"name":"a"},{"id":1,"name":"b"},{"id":2,"name":"c"}]</textarea>
        <input type="text" id="uniqueBy-key" placeholder="键名" value="id">
        <button onclick="testUniqueBy()">测试</button>
      </div>
      <div id="uniqueBy-result" class="result"></div>
    </div>
  </div>

  <!-- 数组比较 -->
  <div class="function-group">
    <h2>数组比较</h2>
    
    <div class="function-item">
      <div class="function-name">difference(arr1, arr2)</div>
      <div class="function-controls">
        <input type="text" id="difference-arr1" placeholder="数组1" value="[1,2,3,4]">
        <input type="text" id="difference-arr2" placeholder="数组2" value="[2,3,5]">
        <button onclick="testDifference()">测试</button>
      </div>
      <div id="difference-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">intersection(arr1, arr2)</div>
      <div class="function-controls">
        <input type="text" id="intersection-arr1" placeholder="数组1" value="[1,2,3,4]">
        <input type="text" id="intersection-arr2" placeholder="数组2" value="[2,3,5]">
        <button onclick="testIntersection()">测试</button>
      </div>
      <div id="intersection-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">union(arr1, arr2)</div>
      <div class="function-controls">
        <input type="text" id="union-arr1" placeholder="数组1" value="[1,2,3]">
        <input type="text" id="union-arr2" placeholder="数组2" value="[3,4,5]">
        <button onclick="testUnion()">测试</button>
      </div>
      <div id="union-result" class="result"></div>
    </div>
  </div>

  <!-- 数组分组 -->
  <div class="function-group">
    <h2>数组分组</h2>
    
    <div class="function-item">
      <div class="function-name">groupBy(arr, key)</div>
      <div class="function-controls">
        <textarea id="groupBy-input" placeholder='对象数组'>[{"age":20,"name":"a"},{"age":20,"name":"b"},{"age":30,"name":"c"}]</textarea>
        <input type="text" id="groupBy-key" placeholder="键名" value="age">
        <button onclick="testGroupBy()">测试</button>
      </div>
      <div id="groupBy-result" class="result"></div>
    </div>
  </div>

  <!-- 数组操作 -->
  <div class="function-group">
    <h2>数组操作</h2>
    
    <div class="function-item">
      <div class="function-name">shuffle(arr)</div>
      <div class="function-controls">
        <input type="text" id="shuffle-input" placeholder="数组" value="[1,2,3,4,5,6,7,8,9,10]">
        <button onclick="testShuffle()">测试</button>
      </div>
      <div id="shuffle-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">move(arr, fromIndex, toIndex)</div>
      <div class="function-controls">
        <input type="text" id="move-arr" placeholder="数组" value="[1,2,3,4,5]">
        <input type="number" id="move-from" placeholder="源索引" value="0">
        <input type="number" id="move-to" placeholder="目标索引" value="3">
        <button onclick="testMove()">测试</button>
      </div>
      <div id="move-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">rotate(arr, count)</div>
      <div class="function-controls">
        <input type="text" id="rotate-arr" placeholder="数组" value="[1,2,3,4,5]">
        <input type="number" id="rotate-count" placeholder="旋转次数" value="2">
        <button onclick="testRotate()">测试</button>
      </div>
      <div id="rotate-result" class="result"></div>
    </div>
  </div>

  <!-- 数组排序 -->
  <div class="function-group">
    <h2>数组排序</h2>
    
    <div class="function-item">
      <div class="function-name">sortBy(arr, key)</div>
      <div class="function-controls">
        <textarea id="sortBy-input" placeholder='对象数组'>[{"age":30,"name":"c"},{"age":20,"name":"a"},{"age":25,"name":"b"}]</textarea>
        <input type="text" id="sortBy-key" placeholder="键名" value="age">
        <button onclick="testSortBy()">测试</button>
      </div>
      <div id="sortBy-result" class="result"></div>
    </div>
  </div>

  <!-- 数组转换 -->
  <div class="function-group">
    <h2>数组转换</h2>
    
    <div class="function-item">
      <div class="function-name">toObject(arr, key, value?)</div>
      <div class="function-controls">
        <textarea id="toObject-input" placeholder='对象数组'>[{"id":1,"name":"a"},{"id":2,"name":"b"}]</textarea>
        <input type="text" id="toObject-key" placeholder="键字段" value="id">
        <input type="text" id="toObject-value" placeholder="值字段(可选)" value="name">
        <button onclick="testToObject()">测试</button>
      </div>
      <div id="toObject-result" class="result"></div>
    </div>
  </div>

  <!-- 树形结构 -->
  <div class="function-group">
    <h2>树形结构</h2>
    
    <div class="function-item">
      <div class="function-name">arrayToTree(arr, options)</div>
      <div class="function-controls">
        <textarea id="arrayToTree-input" placeholder='扁平数组'>[{"id":1,"parentId":null},{"id":2,"parentId":1},{"id":3,"parentId":1}]</textarea>
        <button onclick="testArrayToTree()">测试</button>
      </div>
      <div id="arrayToTree-result" class="result"></div>
    </div>

    <div class="function-item">
      <div class="function-name">treeToArray(tree, options)</div>
      <div class="function-controls">
        <textarea id="treeToArray-input" placeholder='树形结构'>[{"id":1,"children":[{"id":2},{"id":3}]}]</textarea>
        <button onclick="testTreeToArray()">测试</button>
      </div>
      <div id="treeToArray-result" class="result"></div>
    </div>
  </div>

  <script src="../dist/index.umd.js"></script>
  <script>
    // UMD 版本会暴露为全局变量 QUtils
    // 将其转换为命名空间格式以匹配示例代码
    window.qUtils = QUtils;

    // 解析输入数组
    function parseArray(str) {
      try {
        return JSON.parse(str);
      } catch (e) {
        return null;
      }
    }

    // 显示结果
    function showResult(id, result, isError = false) {
      const el = document.getElementById(id);
      el.textContent = typeof result === 'object' ? JSON.stringify(result, null, 2) : String(result);
      el.className = 'result ' + (isError ? 'error' : 'success');
    }

    // 基础操作测试
    window.testIsEmpty = function() {
      const input = parseArray(document.getElementById('isEmpty-input').value);
      if (input === null) {
        showResult('isEmpty-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.isEmpty(input);
      showResult('isEmpty-result', `输入: ${JSON.stringify(input)}\n结果: ${result}`);
    };

    window.testFirst = function() {
      const input = parseArray(document.getElementById('first-input').value);
      if (input === null) {
        showResult('first-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.first(input);
      showResult('first-result', `输入: ${JSON.stringify(input)}\n结果: ${result}`);
    };

    window.testLast = function() {
      const input = parseArray(document.getElementById('last-input').value);
      if (input === null) {
        showResult('last-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.last(input);
      showResult('last-result', `输入: ${JSON.stringify(input)}\n结果: ${result}`);
    };

    window.testChunk = function() {
      const arr = parseArray(document.getElementById('chunk-arr').value);
      const size = parseInt(document.getElementById('chunk-size').value);
      if (arr === null) {
        showResult('chunk-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.chunk(arr, size);
      showResult('chunk-result', `输入: ${JSON.stringify(arr)}, 块大小: ${size}\n结果: ${JSON.stringify(result, null, 2)}`);
    };

    window.testFlatten = function() {
      const input = parseArray(document.getElementById('flatten-input').value);
      if (input === null) {
        showResult('flatten-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.flatten(input);
      showResult('flatten-result', `输入: ${JSON.stringify(input)}\n结果: ${JSON.stringify(result)}`);
    };

    window.testUnique = function() {
      const input = parseArray(document.getElementById('unique-input').value);
      if (input === null) {
        showResult('unique-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.unique(input);
      showResult('unique-result', `输入: ${JSON.stringify(input)}\n结果: ${JSON.stringify(result)}`);
    };

    window.testUniqueBy = function() {
      const arr = parseArray(document.getElementById('uniqueBy-input').value);
      const key = document.getElementById('uniqueBy-key').value;
      if (arr === null) {
        showResult('uniqueBy-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.uniqueBy(arr, key);
      showResult('uniqueBy-result', `输入: ${JSON.stringify(arr)}, 键: ${key}\n结果: ${JSON.stringify(result, null, 2)}`);
    };

    // 数组比较测试
    window.testDifference = function() {
      const arr1 = parseArray(document.getElementById('difference-arr1').value);
      const arr2 = parseArray(document.getElementById('difference-arr2').value);
      if (arr1 === null || arr2 === null) {
        showResult('difference-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.difference(arr1, arr2);
      showResult('difference-result', `数组1: ${JSON.stringify(arr1)}\n数组2: ${JSON.stringify(arr2)}\n差集: ${JSON.stringify(result)}`);
    };

    window.testIntersection = function() {
      const arr1 = parseArray(document.getElementById('intersection-arr1').value);
      const arr2 = parseArray(document.getElementById('intersection-arr2').value);
      if (arr1 === null || arr2 === null) {
        showResult('intersection-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.intersection(arr1, arr2);
      showResult('intersection-result', `数组1: ${JSON.stringify(arr1)}\n数组2: ${JSON.stringify(arr2)}\n交集: ${JSON.stringify(result)}`);
    };

    window.testUnion = function() {
      const arr1 = parseArray(document.getElementById('union-arr1').value);
      const arr2 = parseArray(document.getElementById('union-arr2').value);
      if (arr1 === null || arr2 === null) {
        showResult('union-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.union(arr1, arr2);
      showResult('union-result', `数组1: ${JSON.stringify(arr1)}\n数组2: ${JSON.stringify(arr2)}\n并集: ${JSON.stringify(result)}`);
    };

    // 数组分组测试
    window.testGroupBy = function() {
      const arr = parseArray(document.getElementById('groupBy-input').value);
      const key = document.getElementById('groupBy-key').value;
      if (arr === null) {
        showResult('groupBy-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.groupBy(arr, key);
      showResult('groupBy-result', `输入: ${JSON.stringify(arr)}, 键: ${key}\n结果: ${JSON.stringify(result, null, 2)}`);
    };

    // 数组操作测试
    window.testShuffle = function() {
      const input = parseArray(document.getElementById('shuffle-input').value);
      if (input === null) {
        showResult('shuffle-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.shuffle([...input]);
      showResult('shuffle-result', `输入: ${JSON.stringify(input)}\n打乱后: ${JSON.stringify(result)}`);
    };

    window.testMove = function() {
      const arr = parseArray(document.getElementById('move-arr').value);
      const from = parseInt(document.getElementById('move-from').value);
      const to = parseInt(document.getElementById('move-to').value);
      if (arr === null) {
        showResult('move-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.move([...arr], from, to);
      showResult('move-result', `输入: ${JSON.stringify(arr)}, 从索引${from}移动到索引${to}\n结果: ${JSON.stringify(result)}`);
    };

    window.testRotate = function() {
      const arr = parseArray(document.getElementById('rotate-arr').value);
      const count = parseInt(document.getElementById('rotate-count').value);
      if (arr === null) {
        showResult('rotate-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.rotate([...arr], count);
      showResult('rotate-result', `输入: ${JSON.stringify(arr)}, 旋转${count}次\n结果: ${JSON.stringify(result)}`);
    };

    // 数组排序测试
    window.testSortBy = function() {
      const arr = parseArray(document.getElementById('sortBy-input').value);
      const key = document.getElementById('sortBy-key').value;
      if (arr === null) {
        showResult('sortBy-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.sortBy([...arr], key);
      showResult('sortBy-result', `输入: ${JSON.stringify(arr)}, 按${key}排序\n结果: ${JSON.stringify(result, null, 2)}`);
    };

    // 数组转换测试
    window.testToObject = function() {
      const arr = parseArray(document.getElementById('toObject-input').value);
      const key = document.getElementById('toObject-key').value;
      const value = document.getElementById('toObject-value').value;
      if (arr === null) {
        showResult('toObject-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = value ? qUtils.array.toObject(arr, key, value) : qUtils.array.toObject(arr, key);
      showResult('toObject-result', `输入: ${JSON.stringify(arr)}, 键: ${key}${value ? ', 值: ' + value : ''}\n结果: ${JSON.stringify(result, null, 2)}`);
    };

    // 树形结构测试
    window.testArrayToTree = function() {
      const arr = parseArray(document.getElementById('arrayToTree-input').value);
      if (arr === null) {
        showResult('arrayToTree-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.arrayToTree(arr);
      showResult('arrayToTree-result', `输入: ${JSON.stringify(arr, null, 2)}\n结果: ${JSON.stringify(result, null, 2)}`);
    };

    window.testTreeToArray = function() {
      const tree = parseArray(document.getElementById('treeToArray-input').value);
      if (tree === null) {
        showResult('treeToArray-result', '错误: 无效的数组格式', true);
        return;
      }
      const result = qUtils.array.treeToArray(tree);
      showResult('treeToArray-result', `输入: ${JSON.stringify(tree, null, 2)}\n结果: ${JSON.stringify(result, null, 2)}`);
    };
  </script>
</body>
</html>

